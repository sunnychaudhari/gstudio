{% extends "ndf/base.html" %}
{% load i18n %}
{% load ndf_tags %}
{% load pagination_tags %}

{% block title %} {{ title }} {% endblock %}

{% block style %}
  {{block.super}}

  /* Setting css-properties for app-set in left panel */
    .active-app-set, .active-app-set-edit, .active-app-set-view {
      /*padding:0.5em 0 0.5em 0.5em; */
      /*margin-left: -10px !important;*/
      background-color:#efefef;
    }

    .active-app-set-edit {
      border-right: 4px solid #808080;
      font-weight: bold;
    }

    .active-app-set-view {
      border-left: 4px solid #808080;
      font-weight: bold;
    }

  /* css-properties for table */
    .width_s_no {
      width: 5%;
    }

    .width_gender, .width_edit {
      width: 8%;
    }

    .width_delete {
      width: 8%;
      line-height: 0.5em;
      text-align: center !important;
    }

    .width_dob {
      width: 9%;
    }

    .width_name, .width_email_id {
      width: 31%;
    }

    .margin-0r {
      margin: 0 !important;
    }

    .counter {
      font-weight: bold;
      text-align: right;
    }

    .tiny.button {
      font-size: 1em !important;
    }
{% endblock%}

{% block meta_content %}
  {% check_is_gstaff groupid request.user as gstaff_access %}

  <ul class="side-nav"> 
  	<li>
  		<a></a>
  	</li>

    {% for each in app_collection_set %}
    {% get_memberof_objects_count each.pk groupid as count %}

    {% if app_set_id == each|safe %}
      {% if '/new/' in request.path %}
      <li class="active-app-set-edit">
      {% else %}
      <li class="active-app-set-view">
      {% endif %}
    {% else %}
    <li>
    {% endif %}
    
      <div class="row">
        {% if each.type_of or each.name == "Caste" or each.name == "NUSSD Course" %}
          <a class="large-8 columns" href="{% url 'mis:mis_app_detail' groupid app_id each.pk %}" title="View all {{each.name}}'s">
            {{each.name}} ({{count}})
          </a>

          {% if gstaff_access %}
          <a class="large-4 columns" href="{% url 'mis:mis_app_instance_create' groupid app_id each.pk %}" title="Add {{each.name}}">
            +&nbsp;Add
          </a>
          {% endif %}

        {% else %}
          {{each.name}}
        {% endif %}
      </div>
  	</li>

  	{% endfor %}
  </ul>
{% endblock %}

{% block body_content %} 
  {% if title == "MIS" %}

  <table align="center" cellspacing="0" cellpadding="0" border="0"> 
    <tr> 
      <td>
        <center>
        <img src="/static/ndf/images/India-states-nussd.svg" width="587" border="0" alt="NUSSD Affiliated Universities" title="NUSSD Affiliated Universities" usemap="#India_Map" />
        </center>
      </td>
      <map name="India_Map" id="India_Map"> 
        <area class="state_data" shape="poly" alt="Bhutan" coords="417,254,415,251,418,248,422,241,427,233,432,227,438,224,446,226,446,231,456,231,460,231,461,227,469,232,468,239,472,241,476,241,477,247,479,252,478,254,476,253,470,256,464,256,458,256,454,258,446,256,445,256,441,260,434,260,427,258,423,259" href="#" title="Bhutan" />
        
        <area class="state_data" shape="poly" alt="Nepal" coords="255,223,266,231,271,235,276,240,280,242,283,241,290,245,296,245,299,250,309,251,312,250,318,251,322,250,327,251,333,252,335,259,345,264,353,262,356,267,363,266,375,270,381,268,385,271,399,268,401,270,403,266,403,259,399,254,400,250,401,242,403,241,402,237,389,240,370,234,369,238,363,239,362,234,360,239,353,232,342,231,341,225,332,223,325,219,322,212,319,209,311,213,307,207,295,199,284,193,282,188,273,186,270,190,266,193,263,191,261,191,256,195,251,202,251,205,248,207,249,210,248,213,245,217,246,221,253,224,255,224" href="" title="Nepal" />
        
        <area class="state_data" shape="poly" alt="Meghalaya" coords="441,279,439,282,438,285,438,288,438,291,443,293,447,293,450,293,454,292,459,292,465,291,473,291,480,290,486,291,489,294,490,291,494,290,494,286,492,283,491,281,488,278,483,279,482,273,483,272,483,271,482,271,478,272,476,272,475,271,474,274,462,278,457,277,448,276,443,277" href="" title="Meghalaya" />
        
        <area class="state_data" shape="poly" alt="Bangladesh" coords="427,362,424,348,424,344,422,342,425,337,419,336,419,331,416,329,415,323,416,323,417,324,419,321,418,314,410,313,407,311,404,307,406,301,408,303,411,299,412,295,419,295,421,293,417,289,411,288,407,283,404,282,403,277,408,272,411,269,408,267,409,266,413,269,414,272,416,272,420,268,426,276,431,277,433,271,436,274,436,282,438,284,437,291,447,294,455,293,464,292,473,291,477,290,484,291,488,293,490,295,486,297,485,304,480,312,470,316,468,325,471,333,472,336,474,335,476,340,480,338,481,329,484,324,488,323,491,335,497,350,499,370,494,372,491,376,490,377,480,351,474,343,463,343,455,337,457,341,473,344,478,349,476,353,467,348,469,357,459,357,452,365,447,365,443,360,442,367,437,365,432,370,428,369" href="" title="Bangladesh" />
        
        <area class="state_data" shape="poly" alt="Myanmar" coords="585,422,587,474,581,474,571,488,555,489,552,483,543,487,543,474,548,456,544,439,537,425,526,428,522,425,526,419,522,404,517,399,514,402,516,405,507,400,497,386,491,379,493,374,498,371,501,372,499,358,501,355,504,357,505,357,508,354,507,347,507,335,512,334,511,328,511,318,509,314,510,312,513,315,517,313,522,315,525,316,528,307,531,298,535,289,531,283,536,277,540,266,539,254,547,247,558,238,567,234,573,239,576,237,570,228,578,219,577,213,580,209,584,208,585,209" href="" title="Myanmar" />
        
        <area class="state_data" shape="poly" alt="Jammu and Kashmir" coords="157,143,151,140,145,138,144,134,130,127,125,124,125,114,124,100,123,93,127,92,129,88,134,88,137,82,133,79,129,76,130,72,125,72,122,68,118,64,111,63,109,61,109,56,114,53,120,46,122,44,129,45,133,45,140,42,144,39,149,38,153,41,160,38,164,44,167,49,176,53,179,56,185,61,186,66,198,70,197,74,202,75,214,70,224,66,228,66,232,63,236,67,242,68,244,66,248,72,249,79,246,90,245,93,241,93,240,98,236,98,236,103,234,107,225,107,224,112,228,116,223,117,226,123,231,124,234,125,233,129,234,132,237,135,233,140,229,141,226,144,221,141,221,136,217,138,215,138,213,136,208,138,205,138,205,134,200,130,198,132,193,133,188,130,184,128,184,125,176,126,171,130,169,130,164,131,167,134,166,140,162,141" href="" title="Jammu and Kashmir" />
        
        <area class="state_data" shape="poly" alt="Himachal Pradesh" coords="198,187,202,184,202,174,206,170,209,170,211,168,216,170,219,169,223,172,224,170,224,167,221,162,221,160,220,154,221,151,216,146,215,140,215,137,213,136,208,138,204,138,205,135,200,130,195,133,191,132,184,128,182,126,177,126,171,130,166,131,166,138,166,141,161,148,167,152,168,158,171,162,172,166,177,166,180,169,179,173,183,175,189,181,189,185" href="" title="Himachal Pradesh" />
        
        <area class="state_data" shape="poly" alt="Punjab" coords="128,190,130,184,130,183,133,181,135,176,139,173,143,170,141,167,142,164,143,162,142,156,143,153,148,150,155,148,157,143,166,140,161,148,167,153,168,158,171,161,171,166,177,165,180,170,180,173,184,176,181,177,181,181,185,181,184,187,182,186,179,188,179,193,173,192,171,194,170,198,167,200,161,199,157,199,153,203,151,198,145,195,139,196,132,194,127,194" href="" title="Punjab" />
        
        <area class="state_data" shape="poly" alt="Haryana" coords="191,244,195,241,195,236,197,228,188,230,184,225,184,223,188,219,190,218,188,210,185,204,190,198,195,191,198,187,189,184,189,180,186,177,184,187,181,186,179,188,179,193,173,192,170,198,166,200,161,199,156,199,154,202,150,196,144,195,139,196,138,200,140,202,139,208,146,208,150  
        ,211,156,211,155,214,157,217,158,224,165,232,166,236,165,242,168,243,170,237,173,237,176,241,179,236,183,236,184,241,183,245,185,246,188,244" href="" title="Haryana" />
        
        <area class="state_data" shape="poly" alt="Uttrakhand/Uttaranchal" coords="246,221,246,216,248,212,250,210,248,207,251,204,251,200,259,194,259,191,264,191,263,189,258,186,257,185,252,185,249,182,247,179,242,174,238,173,237,175,234,173,230,169,230,165,227,164,225,165,223,166,224,171,219,169,215,169,212,169,206,170,202,174,202,182,198,187,202,189,205,191,204,194,202,200,207,206,212,201,216,206,223,208,220,210,223,214,226,214,232,219,238,221,242,222" href="" title="Uttrakhand/Uttaranchal" />
        
        <area class="state_data" shape="poly" alt="Rajasthan" coords="68,307,65,300,64,295,60,290,61,283,55,285,51,281,50,276,53,270,52,264,45,264,42,260,40,254,47,247,52,241,56,234,61,234,63,234,67,241,75,239,85,238,88,235,89,231,93,227,98,221,99,216,107,214,111,209,116,202,119,194,127,192,128,194,139,196,139,201,139,208,147,208,151,211,155,210,155,214,157,217,158,224,165,232,166,236,165,241,168,243,171,238,173,236,176,241,179,236,183,236,184,246,188,243,191,244,192,252,195,254,199,255,197,260,194,265,201,264,206,265,207,263,210,265,206,269,198,272,189,277,181,283,175,287,174,293,179,299,186,298,190,297,191,302,181,304,180,309,184,312,185,315,180,315,181,323,177,323,175,321,172,322,167,320,165,324,162,328,158,329,156,331,154,326,159,326,160,323,159,317,163,316,159,310,153,311,151,310,151,305,148,303,145,308,142,305,139,310,139,317,143,324,142,332,139,335,135,338,137,343,133,344,130,345,117,335,112,328,107,319,104,314,97,315,89,309,84,309,80,307,78,307,75,308,72,307" href="" title="Rajasthan" />
        
        <area class="state_data" shape="poly" alt="Gujarat" coords="9,322,12,318,21,319,22,311,29,314,37,314,41,317,46,317,48,313,57,312,57,316,63,316,67,312,65,308,68,307,79,308,91,310,99,314,107,314,108,316,106,319,111,324,114,331,123,339,131,346,131,354,126,356,125,364,125,369,118,371,119,376,127,378,121,380,115,385,119,391,117,396,113,398,109,393,109,401,107,405,101,405,97,400,97,390,95,381,96,373,95,366,95,361,91,361,89,360,83,370,88,374,83,384,71,388,62,391,57,393,49,389,39,379,33,369,24,361,22,355,21,352,25,351,27,356,36,356,45,352,50,347,53,343,58,338,49,339,43,344,31,346,24,343,15,333,11,327" href="" title="Gujarat" />
        
        <area class="state_data" shape="poly" alt="Madhya Pradesh" coords="209,264,206,269,193,274,181,282,174,288,176,297,183,299,191,297,191,301,182,304,180,307,185,312,184,315,179,316,181,323,176,323,173,322,166,320,163,328,156,329,153,326,160,326,159,320,159,317,163,315,159,309,153,311,150,310,151,305,148,303,145,307,142,305,139,312,139,319,143,324,141,332,135,338,137,343,129,345,132,350,130,354,126,355,127,363,126,369,131,367,133,376,141,378,147,382,153,382,163,383,166,389,172,387,177,381,178,378,183,377,185,375,191,375,193,378,190,380,195,383,203,383,210,379,218,381,223,381,226,379,230,376,237,380,244,381,248,379,253,383,257,384,260,378,261,372,262,368,268,361,268,360,274,360,280,355,283,347,286,345,286,341,279,336,276,337,276,334,278,330,284,331,295,330,299,326,298,321,297,316,299,314,297,311,289,313,286,309,281,308,281,305,274,304,269,301,266,307,260,307,261,301,252,305,250,301,250,297,241,301,240,303,232,303,232,299,229,301,223,299,223,295,220,295,217,298,218,306,220,314,224,316,224,321,220,322,214,319,211,319,208,313,208,306,212,299,211,296,213,294,222,289,224,282,226,275,225,271,221,267,216,266" href="" title="Madhya Pradesh" />
        
        <area class="state_data" shape="poly" alt="Uttar Pradesh" coords="279,242,271,236,264,231,254,225,246,222,237,221,229,217,226,214,223,214,220,210,222,208,216,205,213,202,206,206,202,200,204,194,206,191,198,188,190,198,188,203,186,207,189,217,191,217,198,218,197,232,195,236,194,242,191,245,191,251,197,255,195,265,206,264,208,263,216,266,221,267,225,271,226,277,221,289,212,295,211,299,209,308,209,317,214,320,220,322,222,321,223,321,219,309,216,299,221,295,224,300,230,301,233,299,233,302,240,302,245,298,250,297,252,306,260,302,262,307,267,306,270,301,276,304,280,305,282,309,286,309,290,313,296,311,299,314,297,319,300,327,304,329,311,325,311,315,314,313,309,305,309,300,318,295,324,289,327,288,333,288,332,285,322,280,325,275,320,272,324,269,328,268,325,263,320,258,315,251,310,251,308,253,297,249,296,245,292,246,283,241" href="" title="Uttar Pradesh" />
        
        <area class="state_data" shape="poly" alt="Chhattisgarh" coords="274,460,271,463,268,463,265,463,264,453,259,451,258,447,255,443,251,442,250,433,252,429,256,427,258,430,261,428,261,424,255,417,252,416,255,413,255,411,252,411,253,408,256,407,256,397,256,395,253,389,256,384,260,376,262,368,268,360,276,359,281,353,284,347,287,344,286,340,281,337,276,338,278,330,285,331,294,331,299,327,306,329,310,325,317,329,321,336,324,333,324,339,327,345,329,349,330,353,325,356,328,361,317,363,316,367,317,372,313,375,309,388,300,388,296,390,294,395,291,395,293,407,293,411,300,414,299,417,290,414,282,411,283,416,286,420,288,426,290,436,284,444,277,450,274,454" href="" title="Chhattisgarh" />
        
        <area class="state_data" shape="poly" alt="Orissa" coords="341,431,338,431,334,436,331,439,324,438,319,433,313,435,313,439,308,439,306,449,302,446,300,450,294,444,291,447,292,455,285,456,280,459,274,462,273,455,281,446,287,441,290,435,287,423,286,419,282,411,290,414,299,417,300,413,293,411,293,403,292,395,299,387,310,387,312,382,312,375,317,371,317,364,330,361,336,359,344,358,347,363,346,367,350,367,353,365,359,366,362,368,366,365,365,355,371,359,379,362,385,366,385,369,392,368,393,372,399,373,390,377,386,379,383,385,386,393,382,401,382,403,377,407,374,412,358,417,350,423" href="" title="Orissa" />
        
        <area class="state_data" shape="poly" alt="Goa" coords="119,523,121,520,121,515,121,508,119,507,115,507,114,504,110,503,111,510,113,516,108,520,97,518,94,521,95,524,106,524,113,524,115,520" href="" title="Goa" />
        
        <area class="state_data" shape="poly" alt="Maharashtra" coords="103,484,105,492,109,502,113,504,118,506,124,502,127,494,123,494,123,488,131,485,135,482,139,479,144,481,148,479,152,479,153,468,159,472,166,471,168,465,176,464,180,453,186,449,188,447,193,451,193,445,198,442,200,438,198,434,200,427,204,430,208,425,210,416,217,418,222,423,228,424,234,424,240,422,243,427,242,431,243,439,251,442,250,433,254,427,258,429,261,428,261,425,253,416,255,412,252,411,254,409,256,407,255,395,253,389,256,384,248,379,242,381,229,376,223,379,222,381,211,379,204,381,201,383,192,383,191,379,193,377,190,375,185,375,183,377,179,377,177,382,173,387,166,389,161,382,151,382,146,382,139,377,132,375,131,367,120,371,119,376,126,379,116,385,118,390,118,395,113,397,109,395,109,401,106,406,99,405,96,401,94,410,94,422,96,436,98,451,102,469" href="" title="Maharashtra" />
        
        <area class="state_data" shape="poly" alt="Dadra and Nagar Haveli" coords="55,408,55,426,93,427,94,417,95,417,95,407" href="" title="Dadra and Nagar Haveli" />
        
        <area class="state_data" shape="poly" alt="Daman and Diu" coords="61,403,100,403,99,396,63,396,61,396,61,402" href="" title="Daman and Diu" />
        
        <area class="state_data" shape="poly" alt="Karnataka" coords="131,570,138,574,143,578,148,584,154,590,159,590,165,596,174,598,175,592,179,594,182,593,185,594,193,588,193,586,188,584,191,581,191,578,190,576,195,574,197,570,204,572,210,568,214,562,208,561,210,554,202,552,204,548,195,546,194,550,187,551,185,548,180,550,178,549,179,544,186,544,188,539,183,538,178,540,177,535,174,529,175,522,181,522,183,517,180,513,181,502,189,502,190,493,189,492,189,488,189,477,188,475,194,468,190,466,194,457,193,449,188,447,180,455,175,464,168,465,166,471,159,472,152,468,152,480,145,479,145,481,138,479,132,485,124,488,124,494,127,494,125,500,123,505,120,506,122,515,119,524,125,540,130,554,131,564" href="" title="Karnataka" />
        
        <area class="state_data" shape="poly" alt="Andhra Pradesh" coords="239,562,244,558,238,562,233,560,230,563,225,566,217,566,212,573,208,576,204,571,212,567,214,562,210,561,210,554,202,552,203,548,198,546,193,550,189,552,185,548,179,549,178,544,187,544,189,541,187,538,179,539,176,533,175,531,176,523,182,524,183,516,180,513,181,502,188,502,193,507,204,508,212,503,219,503,225,499,231,491,240,488,246,489,246,485,248,482,255,488,258,488,256,485,253,483,256,480,262,481,267,476,274,473,277,469,279,465,281,459,280,459,286,456,290,456,292,451,292,447,294,443,298,451,302,447,307,449,306,444,305,443,308,440,312,438,313,435,318,434,325,437,329,439,335,436,338,431,342,431,338,437,335,441,329,449,319,455,315,458,313,466,306,468,298,474,292,478,292,482,293,485,293,489,280,494,272,494,268,502,264,507,260,505,256,505,250,509,248,515,245,519,246,529,248,536,247,544,250,555,243,559,238,562" href="" title="Andhra Pradesh" />
        
        <area class="state_data" shape="poly" alt="Kerala" coords="179,671,183,666,181,662,180,654,185,643,181,641,182,632,181,625,176,627,173,627,173,618,175,617,175,614,171,613,171,607,166,602,160,599,165,596,159,590,153,589,144,580,141,576,133,570,137,582,144,593,149,602,155,614,158,626,161,640,166,654,173,666" href="" title="Kerala" />
        
        <area class="state_data" shape="poly" alt="Tamilnadu" coords="187,676,179,671,183,666,181,658,181,654,185,643,181,640,182,632,182,625,175,627,173,618,174,614,171,612,171,606,167,604,160,599,165,596,173,598,175,592,179,594,184,594,186,594,191,589,193,586,188,584,192,579,190,574,194,574,197,571,205,573,210,576,215,568,218,566,224,566,233,561,239,562,248,555,252,559,250,567,248,577,245,581,241,589,236,590,238,594,240,603,240,616,240,628,230,627,227,629,226,634,221,642,219,646,222,650,210,654,205,656,203,660,201,669,193,673" href="" title="Tamilnadu" />
        
        <area class="state_data" shape="poly" alt="Lakshadweep" coords="76,648,53,648,33,577,75,574,95,598,97,605,106,606,109,612,106,646" href="" title="Lakshadweep" />
        
        <area class="state_data" shape="poly" alt="Andaman and Nicobar Islands" coords="526,690,569,691,550,650,537,642,526,620,526,598,528,587,575,587,575,574,547,575,546,558,555,540,547,523,536,518,538,509,533,509,514,538,505,548,502,585,499,604,489,612,495,646,512,646" href="" title="Andaman and Nicobar Islands" />
        
        <area class="state_data" shape="poly" alt="Bihar" coords="334,253,326,253,323,249,321,252,316,252,322,262,328,267,324,269,320,272,326,275,322,279,328,283,333,287,333,289,324,289,320,292,316,296,310,299,310,306,314,314,321,314,324,312,329,315,333,319,338,315,343,317,350,314,356,311,357,307,360,307,365,309,368,313,372,315,373,310,381,310,384,308,385,300,392,295,396,294,401,296,397,291,403,288,399,282,397,278,404,273,404,266,401,270,392,270,384,271,380,267,374,270,369,267,361,266,360,268,355,268,355,264,353,262,348,265,340,261,333,259" href="" title="Bihar" />
        
        <area class="state_data" shape="poly" alt="Jharkhand" coords="379,355,382,360,382,363,375,361,365,355,364,359,366,363,362,368,357,365,353,365,351,366,346,367,347,362,343,357,340,359,328,361,326,355,331,352,331,348,327,347,325,343,324,338,323,334,320,335,319,332,317,329,312,325,312,317,313,313,320,315,325,313,330,316,334,319,338,315,346,317,356,311,356,307,362,308,368,313,373,315,373,310,380,310,383,308,386,300,393,296,399,295,400,302,399,311,399,316,395,320,389,325,383,327,380,327,380,329,374,331,370,335,366,334,362,335,361,339,362,342,366,343,371,346,374,346,375,351" href="" title="Jharkhand" />
        
        <area class="state_data" shape="poly" alt="West Bengal" coords="403,262,404,266,404,272,397,279,402,287,403,288,397,291,399,295,400,306,399,317,390,324,379,327,379,329,372,333,370,335,364,334,362,335,361,340,369,345,374,345,376,351,381,356,382,364,387,369,393,369,397,373,405,370,409,369,419,366,426,367,429,365,425,357,424,352,425,343,424,339,419,337,419,332,415,328,416,323,418,321,417,315,409,313,405,309,403,303,406,301,409,303,411,300,411,296,419,296,420,293,417,288,413,289,410,284,403,284,404,277,409,272,409,267,413,268,413,273,417,273,419,269,425,274,427,276,431,277,433,273,436,265,435,261,428,259,421,259,414,253,407,254,399,255" href="" title="West Bengal" />
        
        <area class="state_data" shape="poly" alt="Sikkim" coords="415,243,417,249,415,252,406,254,401,254,400,247,401,240,403,236,408,235,411,231,416,235,416,239" href="" title="Sikkim" />
        
        <area class="state_data" shape="poly" alt="Arunachal Pradesh" coords="479,253,477,248,477,245,477,241,471,240,467,239,468,231,472,235,478,235,479,233,484,233,487,228,488,224,495,221,496,218,501,212,511,210,513,204,518,198,523,195,529,198,537,200,543,192,551,189,555,194,552,197,552,200,558,198,560,202,560,204,556,211,558,212,561,210,570,212,575,214,577,211,578,219,575,220,570,226,576,239,571,239,569,235,565,235,557,239,553,241,548,247,543,253,540,253,537,246,545,241,552,237,548,228,551,222,545,222,543,225,536,226,533,231,521,235,518,238,513,244,509,246,509,250,499,250,497,252,491,249,485,251" href="" title="Arunachal Pradesh" />
        
        <area class="state_data" shape="poly" alt="Assam" coords="435,260,442,259,447,256,451,258,457,257,471,255,481,254,490,249,496,251,499,250,510,250,513,242,521,234,529,233,536,226,544,225,545,222,550,222,548,229,552,237,544,243,537,247,531,251,525,256,524,258,519,258,517,265,517,273,513,274,510,274,506,280,508,285,505,291,501,298,503,306,499,307,497,306,493,310,491,313,488,312,485,305,485,297,490,296,490,293,493,287,491,282,488,279,482,277,482,271,474,272,471,276,465,277,463,279,458,276,448,276,442,277,439,283,436,282,436,276,434,271,436,265" href="" title="Assam" />
        
        <area class="state_data" shape="poly" alt="Nagaland" coords="532,280,538,277,540,267,539,262,537,257,538,253,541,253,538,247,532,249,527,254,523,256,523,259,519,259,517,269,517,273,511,275,508,277,506,282,510,287,512,285,515,280,521,279,523,281,529,276" href="" title="Nagaland" />
        
        <area class="state_data" shape="poly" alt="Manipur" coords="524,315,527,311,527,305,531,297,533,292,535,287,532,286,532,279,529,276,523,280,519,279,515,281,513,286,512,287,508,284,505,290,504,294,501,298,502,306,502,313,507,313,509,313,512,314,516,314,519,315" href="" title="Manipur" />
        
        <area class="state_data" shape="poly" alt="Mizoram" coords="500,359,501,356,505,357,509,353,507,345,506,339,507,335,511,334,510,326,511,319,509,314,503,313,502,307,497,306,493,310,491,313,488,314,489,324,492,332,491,333,493,341,496,344,496,350" href="" title="Mizoram" />
        
        <area class="state_data" shape="poly" alt="Tripura" coords="478,339,480,336,480,332,482,325,488,323,489,312,485,304,480,309,480,312,475,312,471,316,467,320,467,328,471,335,473,339" href="" title="Tripura" />
        
        <area class="state_data" shape="poly" alt="Telangana" coords="193,445,198,442,200,438,198,434,200,427,204,430,208,425,210,417,217,418,222,423,234,424,240,422,243,427,242,432,243,439,251,442,254,443,255,443,258,448,259,451,264,453,265,463,272,462,274,460,281,459,279,465,277,469,275,471,262,481,256,480,253,483,256,485,257,488,254,487,247,482,246,485,246,488,245,489,240,488,230,493,220,504,210,503,205,508,193,507,188,502,189,502,190,493,189,491,189,477,188,474,194,468,191,466,194,457,193,445" href="" title="Telangana" />
        
        <area class="state_data" shape="poly" alt="Delhi" coords="196,228,188,230,184,223,190,218,191,218,197,218,197,228" href="" title="Delhi" />
        
        <area class="state_data" shape="poly" alt="Chandigarh" coords="181,181,186,181,186,177,183,177,181,178,181,180" href="" title="Chandigarh" />
      </map>
    </tr> 
  </table>

  <div id="stateDataModal" class="reveal-modal" data-reveal>
    <div id="university-wise-data">
    </div>

    <a class="close-reveal-modal">&#215;</a>
  </div>

  <!-- Hidden Accordion for University listing -->
  <dl class="accordion university-wise hide" data-accordion>
    <dd class="accordion-navigation">
      <a href="#panel_" class="university-wise"></a>
      <div id="panel_" class="content university-wise">
        <table id="table_">
          <thead>
            <tr>
              <td rowspan="2">{% trans "College" %}</td>
              <td colspan="3" class="text-center">{% trans "Degree Year" %}</td>
              <!-- <td></td> -->
              <!-- <td></td> -->
              <td rowspan="2" class="text-center">{% trans "Total" %}</td>
            </tr>
            <tr>
              <!-- <td></td> -->
              <td class="text-center">{% trans "I" %}</td>
              <td class="text-center">{% trans "II" %}</td>
              <td class="text-center">{% trans "III" %}</td>
              <!-- <td></td> -->
            </tr>
          </thead>
          <tbody>
          </tbody>
        </table>
      </div>
    </dd>
  </dl>

  {% else %}

  {% check_is_gstaff groupid request.user as gstaff_access %}  

  {% if nodes %}
    {% autopaginate nodes 25 %}
  
    <div id="myModal" class="reveal-modal" data-reveal style="height:500px;overflow:scroll;"> 
     {% blocktrans %} <h3>Are you sure you want to delete? All of the following related data also will be deleted:</h3> {% endblocktrans %} 
      <input class="button tiny confirmDeleteObjects" type="button" value="Confirm">
      <input class="button tiny cancelDeleteObjects" type="button" value="Cancel">
      <div id="deletion_results"></div>
      <a class="close-reveal-modal">&#215;</a>
    </div>

    <div class="row" style="margin-top: 1rem;">
      <form method="POST">
        {% csrf_token %}
        <div class="large-5 large-push-7 columns">
          <div class="row collapse">
            <div class="large-10 columns">
              <input type="text" name="search" value="" placeholder="By name...">
            </div>
            <div class="large-2 columns end">
              <input type="submit" class="button postfix" value="Search">
              <input type="hidden" name="class" value="{{class_name}}">
            </div>
          </div>
        </div>
      </form>
    </div>
  {% endif %}

  <table>
    <thead>
      {% if nodes %}
        <th class="width_s_no counter">{% trans "S. #" %}</th>
        {% for each_key in nodes_keys %}
        <th class="width_{{each_key.0}}">{{each_key.1}}</th>
        {% endfor %}
        {% if gstaff_access %}
        <th class="width_edit">{% trans "Edit" %}</th>
        <th class="width_delete"><input class="margin-0r checkedAll" type="checkbox"><br><input class="button tiny margin-0r deleteObjects" type="button" value="Delete"></th>
        {% endif %}
      {% endif %}
    </thead>
    
    <tbody>
      {% for each in nodes %}
        <tr>
          <td class="counter">{{forloop.counter}}.</td>
          {% for each_key in nodes_keys %}
          {% if forloop.counter == 1 %}
          <td>{{each|get_dict_item:each_key.0|title}}</td>
          {% elif forloop.counter > 2 %}
          <td>{{each|get_dict_item:each_key.0|default:"--"}}</td>
          {% else %}
          <td>{{each|get_dict_item:each_key.0}}</td>
          {% endif %}
          {% endfor %}
          {% if gstaff_access %}
          <td class="name"><a href="{% url 'mis:mis_app_instance_edit' groupid app_id app_set_id each|get_dict_item:'_id' %}" target="_blank" class="button tiny expand margin-0r width_edit">Edit</a></td>
          <td id="{{each|get_dict_item:'_id'}}" class="width_delete objectsCheckbox"> <input type="checkbox"> </td>
          {% endif %}
        </tr>
        
      {% empty %}
        {% blocktrans %}<h3>No data to display</h3> {% endblocktrans %}

      {% endfor %}
    </tbody>
  </table>

  {% paginate %}

  {% endif %}
{% endblock %}

{% block script %}
  {{block.super}}

  var state_val = "";
  var university_wise_data = {};

  $(document).on("click", ".state_data", function(event) {
    event.preventDefault();

    if (state_val == $(this).attr("title")) {
      if (state_val != "") {
        $("#stateDataModal").foundation("reveal", "open");
      }
      return false;
    }

    state_val = $(this).attr("title");

    $.ajax({
      url: "{% url 'get_statewise_data' group_id %}",

      data: {
        state_val: state_val
      },

      type: "GET",

      dataType: "json",

      success: function(data){
        success_state = data["success"];

        if (data["success"]) {
          university_wise_data = data["university_wise_data"];
        }
      },

      complete: function(){
        if (success_state) {
          uw_div = $("#stateDataModal").find("#university-wise-data");
          uw_div.html("");

          var university_counter = 0;
          
          university_length = Object.keys(university_wise_data).length;
          if (university_length > 1) {
            title_text = "<h4>" + state_val + " has following NUSSD affiliated Universities: </h4>"
          }
          
          else {
            title_text = "<h4>" + state_val + " has following NUSSD affiliated University: </h4>"
          }
          uw_div.append(title_text);

          $.each(university_wise_data, function(university_name, college_wise_data) {
            university_counter += 1;

            // dl tag
            university_dl = $("dl.university-wise.hide").clone();
            
            // anchor tag
            a_tag = university_dl.find("a.university-wise");
            a_href = a_tag.attr("href");
            a_href += "university_counter_" + university_counter;
            a_tag.text(university_name);
            a_tag.attr("href", a_href);

            // div tag
            div_tag = university_dl.find("div.university-wise");
            div_id = div_tag.attr("id");
            div_id += "university_counter_" + university_counter;
            div_tag.attr("id", div_id);

            // table tag
            table_tag = university_dl.find("table");
            table_tbody = table_tag.find("tbody");
            total_students_in_university = 0;
            $.each(college_wise_data, function(college_name, degree_year_wise) {
              tr_tag = "<tr>"
                + "<td>" + college_name + "</td>"
                + "<td class='text-center'>" + degree_year_wise["I"] + "</td>"
                + "<td class='text-center'>" + degree_year_wise["II"] + "</td>"
                + "<td class='text-center'>" + degree_year_wise["III"] + "</td>"
                + "<td class='text-center'><b>" + degree_year_wise["Total"] + "</b></td>"
                + "</tr>";

              table_tbody.append(tr_tag);
              total_students_in_university += parseInt(degree_year_wise["Total"]);
            });

            // Update University accordion text with total no. of students count
            a_tag.text(university_name + " (Students registered: " + total_students_in_university + ")");

            // Append this university-accordion into university-wise-data
            university_dl.removeClass("hide");
            university_dl.foundation();
            uw_div.append(university_dl);
          });

          $("#stateDataModal").foundation("reveal", "open");
        }
      }
    });
  });

  $(document).on('click', ".checkedAll", function() {
    if($(this).is(":checked")==true) {
      $('.objectsCheckbox input').prop( "checked", true );
    }

    else {
      $('.objectsCheckbox input').prop( "checked", false );
    }
  });

  $(document).on('click', ".button.confirmDeleteObjects", function() {
    var selectedobject = $(".objectsCheckbox input:checked");

    $('#myModal').foundation('reveal', 'open');
    // $('#myModal').foundation('reveal', 'close');
    
    if(selectedobject.length > 0) {
      var i = 0;
      var str = "";  
      
      $.map(selectedobject,function(each){
        if(i == 0) {
          str = str.concat(each.parentElement.id)
        }
        else {
          str = str.concat(","+each.parentElement.id)
        }

        i = i+1;
      });

      $.ajax({
        url: "{% url 'deletion_instances' groupid %}",
        type: 'POST',
        data: {deleteobjects:str,csrfmiddlewaretoken: '{{ csrf_token }}',confirm:"yes"},
    
        beforeSend: function() {},
    
        success: function(result) {},
    
        complete: function() { 
          $('#myModal').foundation('reveal', 'close');
        } 
      });

      $.map(selectedobject,function(each) {
        each.parentElement.parentElement.remove()
      });

      $('#myModal').foundation('reveal', 'close');
    }

    else{
      alert("select object to delete")
    }
  });

  $(document).on('click', ".button.deleteObjects", function(){
    var selectedobject = $(".objectsCheckbox input:checked");
    // $('#myModal').foundation('reveal', 'close');
    
    if(selectedobject.length > 0) {
      var i = 0;
      var str = "";  
   
      $.map(selectedobject, function(each) {
        if(i == 0) {
          str = str.concat(each.parentElement.id)
        }
        else {
          str = str.concat(","+each.parentElement.id)
        }
        i = i+1;
      });

      $.ajax({
        url: "{% url 'deletion_instances' groupid %}",
        type: 'POST',
        data: {deleteobjects: str, csrfmiddlewaretoken: '{{ csrf_token }}'},
    
        beforeSend: function() {},

        success: function(result) {
          $("#deletion_results").html("");

          for(var obj in result){
            var ulist = $("<ul>"+"</ul>")
              .attr("id","conceptlist")
              .appendTo($("#deletion_results"));
      
            var li = $("<li><b>"+result[obj].title+"</b></li>")
              .appendTo(ulist);
      
            var ulist1 = $("<ul>"+"</ul>")
              .attr("id","conceptlist")
              .appendTo(li);
        
            for(var obj2 in result[obj].content) {
              object = result[obj].content[obj2]
              for(var obj3 in  object) {
                for(var each in object[obj3]) {
                  var li1 = $("<li>"+object[obj3][each]+"</li>")
                    .appendTo(ulist1);
                }
              }
            }
          }

          $('#myModal').foundation('reveal', 'open');
        },

        complete: function() {
        }
      });

      // }
    }
    
    else {
      alert("select object to delete")
    }
  });

  $(document).on('click', ".button.cancelDeleteObjects", function() {
    
    $('#myModal').foundation('reveal', 'close');
  });

  $(document).on('open', '#view-map-edit-widget[data-reveal], #view-map-widget[data-reveal]', function() {  
    $.ajax({
      url: "{% url 'get_visited_location' groupid %}",

      success: function(data) { 
        data = JSON.parse(data);

        var lastVisitedLocationVal = data;
        
        if(lastVisitedLocationVal) {
          if(lastVisitedLocationVal == "[]") {
            lastVisitedLocationVal = JSON.parse(lastVisitedLocationVal);
          }

          if(lastVisitedLocationVal.length > 0) {
            // lastVisitedLocationVal = JSON.parse(lastVisitedLocationVal);
            var zoom = lastVisitedLocationVal.pop(),
            lng = lastVisitedLocationVal[1],
            lat = lastVisitedLocationVal[0];
            map.setView([lat, lng], zoom);
          }
        }

        else if( tempArr.length ) {
          var group = new L.featureGroup(tempArr)
          map.fitBounds(group.getBounds());
        }
      }
    });
  });

  $(document).on('opened', '#view-map-edit-widget[data-reveal], #view-map-widget[data-reveal]', function() {  
    
    map.invalidateSize();  
  });

  var startDtInput = $("font:contains('start_time')");
  startDtInput = startDtInput.parent().next().find("input");

  var endDtInput = $("font:contains('end_time')");
  endDtInput = endDtInput.parent().next().find("input");

  if(startDtInput.length > 0) {
    startDtInput.datetimepicker({ 
      hourGrid: 6,
      minuteGrid: 15,

      onClose: function(dateText, inst) {
        if (endDtInput.val() != '') {
          var testStartDate = startDtInput.datetimepicker('getDate');
          var testEndDate = endDtInput.datetimepicker('getDate');

          if (testStartDate > testEndDate)
            endDtInput.datetimepicker('setDate', testStartDate);
        }

        else {
          endDtInput.val(dateText);
        }
      },

      onSelect: function (selectedDateTime) {
        endDtInput.datetimepicker('option', 'minDate', startDtInput.datetimepicker('getDate') );
      }
    });
  }

  if(endDtInput.length > 0) {
    endDtInput.datetimepicker({ 
      hourGrid: 6,
      minuteGrid: 15,
      numberOfMonths: 2,

      onClose: function(dateText, inst) {
        if (startDtInput.val() != '') {
          var testStartDate = startDtInput.datetimepicker('getDate');
          var testEndDate = endDtInput.datetimepicker('getDate');
          if (testStartDate > testEndDate)
            startDtInput.datetimepicker('setDate', testEndDate);
        }

        else {
          startDtInput.val(dateText);
        }
      },

      onSelect: function (selectedDateTime) {
        startDtInput.datetimepicker('option', 'maxDate', endDtInput.datetimepicker('getDate') );
      }
    });
  }

  // totWhen ---------------
  var totWhen = $("font:contains('tot_when')").parent().next().find("input");

  if(totWhen.length > 0) {
    totWhen.datetimepicker();
    $(totWhen).after('&nbsp;<input class="button tiny" type="button" value="Add Date"><br/>')
    $("input.tiny").after("<div id='tot-when-date-list'></div>")
  }

  $(totWhen).change(function(){ 
    if($(totWhen).val().length > 0) {
      $("input.tiny").removeClass("disabled");
    }

    else {
      $("input.tiny").addClass("disabled");
    }
  });

  $("input.tiny").click(function() {
    if(!$(this).hasClass("disabled")) {
      $("#tot-when-date-list").append('<span class="secondary label" style="margin-right:5px;"><span class="date-item">'+$(totWhen).val()+' </span><span style="font-size:large; cursor:pointer;" onclick="$(this).parent().remove();">&times;</span></span>');
      $(totWhen).val("");
      $("input.tiny").addClass("disabled");
    }
  })

  function getTotWhen() {
    var datesList = []
    dts = $("#tot-when-date-list .date-item");
    $.each(dts, function(i, val){datesList.push($(val).text().trim())});

    return datesList;
  }
{% endblock %}	
